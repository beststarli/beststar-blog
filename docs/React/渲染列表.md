---
title: 渲染列表
sidebar_position: 6
tags: [React]
date: 2025-11-12
---

## 用`key`保持列表项的顺序 

对于这样的示例
```jsx
const people = [
  '凯瑟琳·约翰逊: 数学家',
  '马里奥·莫利纳: 化学家',
  '穆罕默德·阿卜杜勒·萨拉姆: 物理学家',
  '珀西·莱温·朱利亚: 化学家',
  '苏布拉马尼扬·钱德拉塞卡: 天体物理学家',
];

export default function List() {
  const listItems = people.map(person =>
    <li>{person}</li>
  );
  return <ul>{listItems}</ul>;
}
```
在控制台会输出一个错误：
:::warning
Each child in a list should have a unique "key" prop.
:::

一个合适的key可以帮助React推断发生了什么，从而得以正确地更新DOM树。用作key的值应该在数据中提前就准备好，而不是在运行时才随手生成。

我们可能会直接把数组项的索引当作key值来用，实际上如果没有显式地指定key值，React确实默认会这么做。但是数组项的顺序在插入、删除或者重新排序等操作中会发生改变，此时把索引顺序用作key值会产生一些微妙且令人困惑的bug。

与之类似，不应该在运行过程中动态地产生key，像是`key={Math.random()}`这种方式。这会导致每次重新渲染后的key值都不一样，从而使得所有的组件和DOM元素每次都要重新创建。这不仅会造成运行变慢的问题，更有可能导致用户输入的丢失。所以，使用能从给定数据中稳定取得的值才是明智的选择。

有一点需要注意，组件不会把key当作props的一部分。Key的存在只对React本身起到提示作用。如果组件需要一个ID，那么应把它作为一个单独的prop传给组件：
```jsx
<Profile key={id} userId={id} />。
```